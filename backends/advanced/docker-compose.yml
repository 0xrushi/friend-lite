# Friend-Lite Docker Compose
# Root compose file using modular includes
#
# Usage:
#   Development:  docker compose up
#   With Mycelia:  docker compose --profile mycelia up
#   With HTTPS:    docker compose --profile https up
#   Testing:       docker compose -f docker-compose.yml -f compose/overrides/test.yml up
#   Production:    docker compose -f docker-compose.yml -f compose/overrides/prod.yml up
#
# Structure:
#   compose/infrastructure.yml    - Core services (mongo, redis, qdrant)
#   compose/backend.yml           - Backend API and workers
#   compose/frontend.yml          - Web UI
#   compose/mycelia.yml           - Mycelia services (--profile mycelia)
#   compose/optional-services.yml - Caddy, Ollama, etc.
#   compose/overrides/            - Environment-specific overrides

include:
  # Core infrastructure (always included)
  - compose/infrastructure.yml

  # Application services (always included)
  - compose/backend.yml
  - compose/frontend.yml

  # Optional services (profile-based)
  - compose/optional-services.yml

  # Note: Mycelia moved to root level (../../compose/mycelia.yml)
  # To use Mycelia, run from project root: docker compose --profile mycelia up

  # Development overrides (default)
  - compose/overrides/dev.yml

# Shared network configuration
networks:
  chronicle-network:
    name: chronicle-network
    external: true

# Shared volume configuration
volumes:
  mongo_data:
    driver: local
  caddy_data:
    driver: local
  caddy_config:
    driver: local
  ollama_data:
    driver: local
  neo4j_data:
    driver: local
  neo4j_logs:
    driver: local
